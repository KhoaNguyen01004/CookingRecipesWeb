@model CookingRecipesWeb.Models.Recipe

@{
    ViewData["Title"] = Model.StrMeal;
}

<div class="container mt-4">
    <div class="row">
        <div class="col-md-4">
            <img src="@Model.StrMealThumb" class="img-fluid rounded" alt="@Model.StrMeal">
        </div>
        <div class="col-md-8">
            <h1>@Model.StrMeal</h1>
            <p><strong>Category:</strong> @Model.StrCategory</p>
            <p><strong>Area:</strong> @Model.StrArea</p>
            <h3>Ingredients</h3>
            <ul>
                @if (!string.IsNullOrEmpty(Model.StrIngredients) && !string.IsNullOrEmpty(Model.StrMeasures))
                {
                    var ingredients = Model.StrIngredients.Split(',');
                    var measures = Model.StrMeasures.Split(',');
                    for (int i = 0; i < Math.Min(ingredients.Length, measures.Length); i++)
                    {
                        var ingredient = ingredients[i]?.Trim();
                        var measure = measures[i]?.Trim();
                        if (!string.IsNullOrEmpty(ingredient))
                        {
                            <li>@measure @ingredient</li>
                        }
                    }
                }
            </ul>
            <h3>Instructions</h3>
            <p>@Model.StrInstructions</p>
            @if (!string.IsNullOrEmpty(Model.StrYoutube))
            {
                <h3>Video Tutorial</h3>
                var videoId = Model.StrYoutube.Split("v=")[1]?.Split("&")[0];
                var embedUrl = $"https://www.youtube.com/embed/{videoId}";
                <div class="ratio ratio-16x9">
                    <iframe src="@embedUrl" title="YouTube video player" frameborder="0"
                        allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
                        allowfullscreen></iframe>
                </div>
            }
        </div>
    </div>
    <div class="mt-4">
        @if (Context.Session.GetString("UserId") != null)
        {
            <button id="favorite-btn" class="btn btn-outline-warning mt-4 me-2">
                <i class="bi bi-heart"></i> <span id="favorite-text">Add to Favorites</span>
            </button>
        }
        <a href="@Url.Action("Index", "Home")" class="btn btn-secondary mt-4">Back to Recipes</a>
    </div>
</div>

@section Scripts {
    <script src="~/js/recipe-details.js" asp-append-version="true"></script>
}